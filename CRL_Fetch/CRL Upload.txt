#check# CRL Upload
# 21AUG25

# Source and destination paths
$sourcePath = "G:\new_crls\new_crls"
$destinationPath = "Destination_Goes_Here"

# Check if source directory exists
if (!(Test-Path $sourcePath)) {
    Write-Host "Error: Source Directory does not exist: $sourcePath" -ForegroundColor Red
    exit 1
}

# Check if destination directory exists
if (!(Test-Path $destinationPath)) {
    Write-Host "Error: Destination Directory does not exist: $sourcePath" -ForegroundColor Red
    exit 1
}

# Retrieve .crl files from source
$crlFiles = Get-ChildItem -Path $sourcePath -Filter "*.crl" -File

# Check if any .crl files were found
if ($crlFiles -eq 0) {
    Write-Host "No .crl files found in $sourcePath" -ForegroundColor Yellow
    exit 0
}

# Copy and overwrite all .crl files
foreach ($file in $crlFiles) {
    try {
        Copy-Item -Path $file.FullName -Destination $destinationPath -Force
        Write-Host "Successfully copied: $($file.name)" -ForegroundColor Green
    }
    catch {
        Write-Host "Failed to copy $($file.name): $_" -ForegroundColor Red
    }
}


Write-Host "File transfer completed! Copied $($crlFiles.Count) CRL Files." -ForegroundColor Cyan
